Wazuh server configuration

-	Add the following decoders to the Wazuh server /var/ossec/etc/decoders/local_decoder.xml file. This allows extracting the information from YARA scan results

<decoder name="yara_decoder">
    <prematch>wazuh-yara:</prematch>
</decoder>

<decoder name="yara_decoder1">
    <parent>yara_decoder</parent>
    <regex>wazuh-yara: (\S+) - Scan result: (\S+) (\S+)</regex>
    <order>log_type, yara_rule, yara_scanned_file</order>
</decoder>

-	Create new rules in /var/ossec/etc/rules/local_rules.xml

<!-- YARA rules -->
<!-- Windows FIM monitoring -->
<group name="syscheck,yara">
 <rule id="110300" level="10">
    <if_sid>550</if_sid>
    <field name="file">
      <match>^C:\\projects\\.*</match>
    </field>
    <description>File modified in C:\projects directory (Windows).</description>
  </rule>

  <rule id="110301" level="10">
    <if_sid>554</if_sid>
    <field name="file">
      <match>^C:\\projects\\.*</match>
    </field>
    <description>File added to C:\projects directory (Windows).</description>
  </rule>
</group>

<group name="yara,">
  <rule id="108000" level="0">
    <decoded_as>yara_decoder</decoded_as>
    <description>Yara grouping rule</description>
  </rule>

  <rule id="108001" level="12">
    <if_sid>108000</if_sid>
    <match>wazuh-yara: INFO - Scan result: </match>
    <description>File "$(yara_scanned_file)" is a positive match. Yara rule: $(yara_rule)</description>
  </rule>
</group>

-	Add the following configuration to the Wazuh server /var/ossec/etc/ossec.conf file
<ossec_config>
  <command>
    <name>yara_windows</name>
    <executable>yara.bat</executable>
    <timeout_allowed>no</timeout_allowed>
  </command>

  <active-response>
    <disabled>no</disabled>
    <command>yara_windows</command>
    <location>local</location>
    <rules_id>554,550</rules_id>
  </active-response>
</ossec_config>

-	Restart the Wazuh manager to apply the configuration changes
sudo systemctl restart wazuh-manager
