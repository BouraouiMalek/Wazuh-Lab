In Windows endpoint
1- In the Wazuh agent C:\Program Files (x86)\ossec-agent\ossec.conf file we have to make sure that <disabled> is set to no
2- Download the Python executable installer from the official Python website.
3- Run the Python installer 
4- Once Python completes the installation process open an administrator PowerShell terminal and use pip to install PyInstaller:
pip install pyinstaller
pyinstaller --version

5- Create an active response script remove-threat.py to remove a file from the Windows endpoint
6- Convert the active response Python script remove-threat.py to a Windows executable application
pyinstaller -F \path_to_remove-threat.py

7- Make sure that remove-threat.exe is in the C:\Program Files (x86)\ossec-agent\active-response\bin directory.


8- In Wazuh server ossec.conf add 
<command>
  <name>remove-threat-windows</name>
  <executable>remove-threat.sh</executable>
  <timeout_allowed>no</timeout_allowed>
</command>
<active-response>
    <disabled>no</disabled>
    <command>remove-threat-windows</command>
    <location>local</location>
    <rules_id>100201</rules_id>
</active-response>
